<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/7b0b24f36b1a6d0b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/14914623d32d605a.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c9b793a5deeb135f.js"/><script src="/_next/static/chunks/4bd1b696-aaf09b882924c802.js" async=""></script><script src="/_next/static/chunks/517-1aa39bab3933c6e2.js" async=""></script><script src="/_next/static/chunks/main-app-eb4ba1fd5bb32f2e.js" async=""></script><script src="/_next/static/chunks/app/layout-fc61d8c659479b00.js" async=""></script><script src="/_next/static/chunks/208-673db12e6e83b7c3.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-8507fdcc32d83c40.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-QY2VMWMXL2" as="script"/><meta name="next-size-adjust" content=""/><title>Pensamentos sobre arquitetura do Rails | Blog de Vinicius Lisboa</title><meta name="description" content="Ou como o Rails enxerga soluções para os problemas classicos da arquitetura"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="robots" content="index, follow"/><meta property="og:title" content="Pensamentos sobre arquitetura do Rails"/><meta property="og:description" content="Ou como o Rails enxerga soluções para os problemas classicos da arquitetura"/><meta property="og:url" content="https://viniciuslisboa07.github.io/blog/pensamentos-sobre-arquitetura-rails"/><meta property="og:site_name" content="Blog de Vinicius Lisboa"/><meta property="og:image" content="http://localhost:3000/images/blog/arquitetura-rails.png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Pensamentos sobre arquitetura do Rails"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-12-09"/><meta property="article:author" content="Vinicius Lisboa"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Pensamentos sobre arquitetura do Rails"/><meta name="twitter:description" content="Ou como o Rails enxerga soluções para os problemas classicos da arquitetura"/><meta name="twitter:image" content="http://localhost:3000/images/blog/arquitetura-rails.png"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link rel="icon" href="/icon?eacec83176f30837" type="image/png" sizes="32x32"/><script>(self.__next_s=self.__next_s||[]).push(["https://www.googletagmanager.com/gtag/js?id=G-QY2VMWMXL2",{}])</script><script>(self.__next_s=self.__next_s||[]).push([0,{"children":"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'G-QY2VMWMXL2');\n          ","id":"google-analytics"}])</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_ed3508"><section class="py-20 pt-32 bg-white text-black"><div class="container mx-auto px-8"><a class="flex items-center text-green-600 mb-8 font-medium" href="/blog"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>back_to_blog</a><div style="opacity:0;transform:translateY(20px)"><h1 class="text-4xl md:text-5xl font-black mb-6">Pensamentos sobre arquitetura do Rails</h1><div class="flex items-center mb-8"><div class="flex items-center mr-6"><div class="w-10 h-10 rounded-full bg-gray-200 mr-3 relative"><img alt="Vinicius Lisboa" loading="lazy" decoding="async" data-nimg="fill" class="rounded-full" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" src="/images/vinicius.jpeg"/></div><span class="font-medium">Vinicius Lisboa</span></div><div class="text-gray-500">08/12/2025</div></div><div class="aspect-video bg-gray-200 rounded-xl mb-8 overflow-hidden relative"><img alt="Pensamentos sobre arquitetura do Rails" loading="lazy" decoding="async" data-nimg="fill" class="object-cover" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/images/blog/arquitetura-rails.png"/></div><div class="flex gap-2 mb-8"><span class="px-3 py-1 bg-gray-100 text-sm rounded-full text-gray-600">Ruby</span><span class="px-3 py-1 bg-gray-100 text-sm rounded-full text-gray-600">Rails</span><span class="px-3 py-1 bg-gray-100 text-sm rounded-full text-gray-600">DDD</span><span class="px-3 py-1 bg-gray-100 text-sm rounded-full text-gray-600">ActiveRecord</span><span class="px-3 py-1 bg-gray-100 text-sm rounded-full text-gray-600">Arquitetura</span></div><article class="prose prose-lg mx-auto max-w-4xl"><p class="text-gray-700 leading-relaxed mb-4">Li recentemente um <a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/">texto</a> muito interessante do Daniel Frydman (aliás, um ótimo blog que tenho gostado muito de acompanhar e tem me inspirado a escrever mais.) onde ele aplica os conceitos de arquitetura hexagonal a um projeto Rails. Acredito que a aplicação proposta é uma ótima maneira de enxergar o problema e tem benefícios claros como ele mesmo demonstra em seu texto.</p>
<p class="text-gray-700 leading-relaxed mb-4">No entanto esse assunto me deixou com uma pulga atrás da orelha, e eu gostaria de externalizar isso neste texto onde eu pretendo tentar entender os conceitos de arquitetura hexagonal como proposto por Alistair Cockburn e como isso &quot;conflita&quot; com alguns dos pensamentos por trás do conhecido <em class="italic text-gray-700">Rails Way</em>.</p>
<p class="text-gray-700 leading-relaxed mb-4">As ideias (ou pelo menos sua difusão) de Cockburn com Hexagonal, Bob Martin com Clean Arch, Eric Evans com DDD parecem partir de um ponto em comum: o domínio da sua aplicação, isto é aquilo que chamamos de lógica de negócio, deve estar isolada das outras camadas camadas da aplicação.</p>
<p class="text-gray-700 leading-relaxed mb-4">Cockburn especificamente propõe que o domínio deve ser isolada da <em class="italic text-gray-700">infraestrutura</em>: a lógica de negócio fica no “núcleo”, conectando-se ao mundo externo apenas através de “portas” e “adaptadores”. O núcleo não sabe se está conversando com uma interface gráfica, HTTP ou um banco de dados, tudo isso é abstraído via contratos claros de entrada e saída (os ja mencionados <em class="italic text-gray-700">ports/adapters</em>), permitindo fácil troca, adaptação e, principalmente, a <em class="italic text-gray-700">testabilidade independente do ambiente externo</em>.<a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://blog.everestek.com/a-deep-dive-into-hexagonal-architecture-principles-and-practices-2/"></a></p>
<p class="text-gray-700 leading-relaxed mb-4"><div class="my-8 flex justify-center"><img alt="Image description" loading="lazy" width="600" height="300" decoding="async" data-nimg="1" class="rounded-lg shadow-lg max-w-2xl w-full h-auto" style="color:transparent" src="/images/blog/hexFig4.png"/></div></p>
<p class="text-gray-700 leading-relaxed mb-4">O Rails no entanto segue por um outro caminho, e o cerne da questão parece pra mim ao menos, repousar sobre o <em class="italic text-gray-700">ActiveRecord</em>. Martin Fowler define active record em <em class="italic text-gray-700">Patterns of Enterprise Application Architecture</em> como:</p>
<blockquote class="border-l-4 border-green-500 pl-4 italic text-gray-600 mb-6">
<p class="text-gray-700 leading-relaxed mb-4">An object that wraps a row in a database table or view, encapsulates the database access, and adds domain logic on that data.</p>
</blockquote>
<p class="text-gray-700 leading-relaxed mb-4"><div class="my-8 flex justify-center"><img alt="Image description" loading="lazy" width="600" height="300" decoding="async" data-nimg="1" class="rounded-lg shadow-lg max-w-2xl w-full h-auto" style="color:transparent" src="/images/blog/active-record.png"/></div></p>
<p class="text-gray-700 leading-relaxed mb-4">Num primeiro momento essa ideia parece estranha. Coisas diferentes parecem melhores se mantidas separadas, cada uma com suas responsabilidades. Por que juntar comportamento de domínio com persistência? Por que um objeto que “representa” uma entidade do negócio deveria também saber como se salvar no banco? Parece uma violação obvia do isolamento de dominio. E de fato isso, como DHH aponta em seus textos, virou quase uma espécie de <em class="italic text-gray-700">dogma arquitetural</em>.</p>
<p class="text-gray-700 leading-relaxed mb-4">No entanto ao voltarmos a luz da orientação a objetos para o problema parece que as coisas começam a se encaixar. A ideia de <em class="italic text-gray-700">encapsulação</em> defendida por autores como Alan Kay (criador do termo OO) e Kent Beck (com o SmallTalk) propoe que objetos devem ter controle seus proprios <em class="italic text-gray-700">estados</em> e <em class="italic text-gray-700">comportamentos</em>, assim como no active record. E a separação estrita e mal aplicada dessa dessas duas camadas pode gerar aquilo que o Fowler chamou de <a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://martinfowler.com/bliki/AnemicDomainModel.html">Anemic Domain Model</a>, modelos que são meramente conjuntos de dados, sem nenhuma lógica (justamente o que o DDD quer solucionar, ironicamente).</p>
<p class="text-gray-700 leading-relaxed mb-4">Todo esse problema reside no fato de que nosso banco de dados e nossa aplicação são coisas diferentes que precisam se comunicar. Que precisam encontrar um meio de transportar informação. O active record, diferentemente de muitos ORM&#x27;s, se importa com ambas as partes, foi desenhado para que a camada de dominio e a persistencia dos dados fiquem juntas.</p>
<p class="text-gray-700 leading-relaxed mb-4">Nas palavras de <a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://dev.37signals.com/active-record-nice-and-blended/">Jorge Manrubia</a>:</p>
<blockquote class="border-l-4 border-green-500 pl-4 italic text-gray-600 mb-6">
<p class="text-gray-700 leading-relaxed mb-4">In a database-powered application, domain logic is indissolubly linked to persistence. Is isolating persistence a goal or mitigation against not having the right ORM (Object Relational Mapping) technology in place? My point of view is that <em class="italic text-gray-700">if</em> the ORM perfectly blends with the host language, and <em class="italic text-gray-700">if</em> it comes with good answers for persisting your object models, and <em class="italic text-gray-700">if</em> it offers good encapsulation mechanisms, then the original question gets restated. Instead of <em class="italic text-gray-700">“how can I isolate persistence from domain logic”</em>, it becomes <em class="italic text-gray-700">“why would I”</em>?</p>
</blockquote>
<p class="text-gray-700 leading-relaxed mb-4">Referencias:</p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/">https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/</a></p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://www.martinfowler.com/eaaCatalog/activeRecord.html">https://www.martinfowler.com/eaaCatalog/activeRecord.html</a></p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://martinfowler.com/articles/badri-hexagonal/">https://martinfowler.com/articles/badri-hexagonal/</a></p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://dev.37signals.com/active-record-nice-and-blended/">https://dev.37signals.com/active-record-nice-and-blended/</a></p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://dev.37signals.com/vanilla-rails-is-plenty/">https://dev.37signals.com/vanilla-rails-is-plenty/</a></p>
<p class="text-gray-700 leading-relaxed mb-4"><a class="text-green-600 hover:text-green-700 hover:underline transition-colors" href="https://martinfowler.com/bliki/AnemicDomainModel.html">https://martinfowler.com/bliki/AnemicDomainModel.html</a></p></article><div class="border-t border-gray-200 mt-12 pt-8"><h3 class="text-2xl font-bold mb-6">share_post</h3><div class="flex gap-4"><button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></button><button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd"></path></svg></button><button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"></path></svg></button><button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg></button></div></div></div></div></section><script src="/_next/static/chunks/webpack-c9b793a5deeb135f.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[3704,[\"177\",\"static/chunks/app/layout-fc61d8c659479b00.js\"],\"\"]\n3:I[5244,[],\"\"]\n4:I[3866,[],\"\"]\n6:I[6213,[],\"OutletBoundary\"]\n8:I[6213,[],\"MetadataBoundary\"]\na:I[6213,[],\"ViewportBoundary\"]\nc:I[4835,[],\"\"]\n:HL[\"/_next/static/media/7b0b24f36b1a6d0b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/14914623d32d605a.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"vIR5sWEpyy7FgVUFyZe3H\",\"p\":\"\",\"c\":[\"\",\"blog\",\"pensamentos-sobre-arquitetura-rails\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"pensamentos-sobre-arquitetura-rails\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/14914623d32d605a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"$L2\",null,{\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-QY2VMWMXL2\",\"strategy\":\"beforeInteractive\"}],[\"$\",\"$L2\",null,{\"id\":\"google-analytics\",\"strategy\":\"beforeInteractive\",\"children\":\"\\n            window.dataLayer = window.dataLayer || [];\\n            function gtag(){dataLayer.push(arguments);}\\n            gtag('js', new Date());\\n            gtag('config', 'G-QY2VMWMXL2');\\n          \"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_ed3508\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"pensamentos-sobre-arquitetura-rails\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":\"$L7\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"9wayOruHCKSME1a8dyzok\",{\"children\":[[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$c\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"d:I[3818,[\"208\",\"static/chunks/208-673db12e6e83b7c3.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-8507fdcc32d83c40.js\"],\"default\"]\ne:I[7970,[\"208\",\"static/chunks/208-673db12e6e83b7c3.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-8507fdcc32d83c40.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"$Ld\",null,{\"post\":{\"meta\":{\"slug\":\"pensamentos-sobre-arquitetura-rails\",\"title\":\"Pensamentos sobre arquitetura do Rails\",\"excerpt\":\"Ou como o Rails enxerga soluções para os problemas classicos da arquitetura\",\"date\":\"2025-12-09\",\"imageUrl\":\"/images/blog/arquitetura-rails.png\",\"tags\":[\"Ruby\",\"Rails\",\"DDD\",\"ActiveRecord\",\"Arquitetura\"],\"author\":{\"name\":\"Vinicius Lisboa\",\"imageUrl\":\"/images/vinicius.jpeg\"}},\"content\":[[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"Li recentemente um \",[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/\",\"children\":\"texto\"}],\" muito interessante do Daniel Frydman (aliás, um ótimo blog que tenho gostado muito de acompanhar e tem me inspirado a escrever mais.) onde ele aplica os conceitos de arquitetura hexagonal a um projeto Rails. Acredito que a aplicação proposta é uma ótima maneira de enxergar o problema e tem benefícios claros como ele mesmo demonstra em seu texto.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"No entanto esse assunto me deixou com uma pulga atrás da orelha, e eu gostaria de externalizar isso neste texto onde eu pretendo tentar entender os conceitos de arquitetura hexagonal como proposto por Alistair Cockburn e como isso \\\"conflita\\\" com alguns dos pensamentos por trás do conhecido \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"Rails Way\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":\"As ideias (ou pelo menos sua difusão) de Cockburn com Hexagonal, Bob Martin com Clean Arch, Eric Evans com DDD parecem partir de um ponto em comum: o domínio da sua aplicação, isto é aquilo que chamamos de lógica de negócio, deve estar isolada das outras camadas camadas da aplicação.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"Cockburn especificamente propõe que o domínio deve ser isolada da \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"infraestrutura\"}],\": a lógica de negócio fica no “núcleo”, conectando-se ao mundo externo apenas através de “portas” e “adaptadores”. O núcleo não sabe se está conversando com uma interface gráfica, HTTP ou um banco de dados, tudo isso é abstraído via contratos claros de entrada e saída (os ja mencionados \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"ports/adapters\"}],\"), permitindo fácil troca, adaptação e, principalmente, a \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"testabilidade independente do ambiente externo\"}],\".\",[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://blog.everestek.com/a-deep-dive-into-hexagonal-architecture-principles-and-practices-2/\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"my-8 flex justify-center\",\"children\":[\"$\",\"$Le\",null,{\"src\":\"/images/blog/hexFig4.png\",\"alt\":\"Image description\",\"width\":600,\"height\":300,\"className\":\"rounded-lg shadow-lg max-w-2xl w-full h-auto\"}]}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"O Rails no entanto segue por um outro caminho, e o cerne da questão parece pra mim ao menos, repousar sobre o \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"ActiveRecord\"}],\". Martin Fowler define active record em \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"Patterns of Enterprise Application Architecture\"}],\" como:\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"border-l-4 border-green-500 pl-4 italic text-gray-600 mb-6\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":\"An object that wraps a row in a database table or view, encapsulates the database access, and adds domain logic on that data.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"my-8 flex justify-center\",\"children\":[\"$\",\"$Le\",null,{\"src\":\"/images/blog/active-record.png\",\"alt\":\"Image description\",\"width\":600,\"height\":300,\"className\":\"rounded-lg shadow-lg max-w-2xl w-full h-auto\"}]}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"Num primeiro momento essa ideia parece estranha. Coisas diferentes parecem melhores se mantidas separadas, cada uma com suas responsabilidades. Por que juntar comportamento de domínio com persistência? Por que um objeto que “representa” uma entidade do negócio deveria também saber como se salvar no banco? Parece uma violação obvia do isolamento de dominio. E de fato isso, como DHH aponta em seus textos, virou quase uma espécie de \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"dogma arquitetural\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"No entanto ao voltarmos a luz da orientação a objetos para o problema parece que as coisas começam a se encaixar. A ideia de \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"encapsulação\"}],\" defendida por autores como Alan Kay (criador do termo OO) e Kent Beck (com o SmallTalk) propoe que objetos devem ter controle seus proprios \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"estados\"}],\" e \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"comportamentos\"}],\", assim como no active record. E a separação estrita e mal aplicada dessa dessas duas camadas pode gerar aquilo que o Fowler chamou de \",[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://martinfowler.com/bliki/AnemicDomainModel.html\",\"children\":\"Anemic Domain Model\"}],\", modelos que são meramente conjuntos de dados, sem nenhuma lógica (justamente o que o DDD quer solucionar, ironicamente).\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":\"Todo esse problema reside no fato de que nosso banco de dados e nossa aplicação são coisas diferentes que precisam se comunicar. Que precisam encontrar um meio de transportar informação. O active record, diferentemente de muitos ORM's, se importa com ambas as partes, foi desenhado para que a camada de dominio e a persistencia dos dados fiquem juntas.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"Nas palavras de \",[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://dev.37signals.com/active-record-nice-and-blended/\",\"children\":\"Jorge Manrubia\"}],\":\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"border-l-4 border-green-500 pl-4 italic text-gray-600 mb-6\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"In a database-powered application, domain logic is indissolubly linked to persistence. Is isolating persistence a goal or mitigation against not having the right ORM (Object Relational Mapping) technology in place? My point of view is that \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"if\"}],\" the ORM perfectly blends with the host language, and \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"if\"}],\" it comes with good answers for persisting your object models, and \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"if\"}],\" it offers good encapsulation mechanisms, then the original question gets restated. Instead of \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"“how can I isolate persistence from domain logic”\"}],\", it becomes \",[\"$\",\"em\",null,{\"className\":\"italic text-gray-700\",\"children\":\"“why would I”\"}],\"?\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":\"Referencias:\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/\",\"children\":\"https://danonrails.wordpress.com/2025/10/14/hexagonal-architecture-in-rails-set-your-business-logic-free/\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://www.martinfowler.com/eaaCatalog/activeRecord.html\",\"children\":\"https://www.martinfowler.com/eaaCatalog/activeRecord.html\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://martinfowler.com/articles/badri-hexagonal/\",\"children\":\"https://martinfowler.com/articles/badri-hexagonal/\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://dev.37signals.com/active-record-nice-and-blended/\",\"children\":\"https://dev.37signals.com/active-record-nice-and-blended/\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://dev.37signals.com/vanilla-rails-is-plenty/\",\"children\":\"https://dev.37signals.com/vanilla-rails-is-plenty/\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-gray-700 leading-relaxed mb-4\",\"children\":[\"$\",\"a\",null,{\"className\":\"text-green-600 hover:text-green-700 hover:underline transition-colors\",\"href\":\"https://martinfowler.com/bliki/AnemicDomainModel.html\",\"children\":\"https://martinfowler.com/bliki/AnemicDomainModel.html\"}]}]]}}]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Pensamentos sobre arquitetura do Rails | Blog de Vinicius Lisboa\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Ou como o Rails enxerga soluções para os problemas classicos da arquitetura\"}],[\"$\",\"link\",\"3\",{\"rel\":\"manifest\",\"href\":\"/manifest.webmanifest\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Pensamentos sobre arquitetura do Rails\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"Ou como o Rails enxerga soluções para os problemas classicos da arquitetura\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:url\",\"content\":\"https://viniciuslisboa07.github.io/blog/pensamentos-sobre-arquitetura-rails\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:site_name\",\"content\":\"Blog de Vinicius Lisboa\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"http://localhost:3000/images/blog/arquitetura-rails.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image:alt\",\"content\":\"Pensamentos sobre arquitetura do Rails\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:published_time\",\"content\":\"2025-12-09\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:author\",\"content\":\"Vinicius Lisboa\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:title\",\"content\":\"Pensamentos sobre arquitetura do Rails\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:description\",\"content\":\"Ou como o Rails enxerga soluções para os problemas classicos da arquitetura\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:image\",\"content\":\"http://localhost:3000/images/blog/arquitetura-rails.png\"}],[\"$\",\"link\",\"20\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"21\",{\"rel\":\"icon\",\"href\":\"/icon?eacec83176f30837\",\"alt\":\"$undefined\",\"type\":\"image/png\",\"sizes\":\"32x32\"}]]\n"])</script><script>self.__next_f.push([1,"7:null\n"])</script></body></html>