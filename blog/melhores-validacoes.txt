1:"$Sreact.fragment"
2:I[3704,["177","static/chunks/app/layout-fc61d8c659479b00.js"],""]
3:I[5244,[],""]
4:I[3866,[],""]
6:I[6213,[],"OutletBoundary"]
8:I[6213,[],"MetadataBoundary"]
a:I[6213,[],"ViewportBoundary"]
c:I[4835,[],""]
:HL["/_next/static/media/7b0b24f36b1a6d0b-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/be4d4537d931865e.css","style"]
0:{"P":null,"b":"CUJ4jTie2SjES6UUVusb_","p":"","c":["","blog","melhores-validacoes"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","melhores-validacoes","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/be4d4537d931865e.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","$L2",null,{"src":"https://www.googletagmanager.com/gtag/js?id=G-QY2VMWMXL2","strategy":"beforeInteractive"}],["$","$L2",null,{"id":"google-analytics","strategy":"beforeInteractive","children":"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            gtag('js', new Date());\n            gtag('config', 'G-QY2VMWMXL2');\n          "}]]}],["$","body",null,{"className":"__className_ed3508","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","melhores-validacoes","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":"$L7"}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","zu9HwltT64X9FiTwdehVf",{"children":[["$","$L8",null,{"children":"$L9"}],["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$c","$undefined"],"s":false,"S":true}
d:I[3818,["208","static/chunks/208-673db12e6e83b7c3.js","953","static/chunks/app/blog/%5Bslug%5D/page-e1b8cea791f2297e.js"],"default"]
e:I[7970,["208","static/chunks/208-673db12e6e83b7c3.js","953","static/chunks/app/blog/%5Bslug%5D/page-e1b8cea791f2297e.js"],"Image"]
5:["$","$Ld",null,{"post":{"meta":{"slug":"melhores-validacoes","title":"Melhores Validações","excerpt":"Validando on rails","date":"2025-12-27","imageUrl":"/images/blog/validacao.png","tags":["Rails"],"author":{"name":"Vinicius Lisboa","imageUrl":"/images/vinicius.jpeg"}},"content":[["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["Uma distinção muito simples e interessante trazida pelo livro ",["$","em",null,{"className":"italic text-gray-700","children":"Layerd Design for Ruby on Rails Applications"}]," é a de validações de Transação e validações de Consistência. A primeira trata de validações que definem quando e como um estado pode ser alterado e a segunda trata de validações que restringem o que deve ou não ser alterado. No exemplo do livro:"]}],"\n",["$","ul",null,{"className":"list-disc pl-6 mb-6 space-y-2","children":["\n",["$","li",null,{"className":"text-gray-700","children":["Uma publicação (de um blog, por exemplo) não pode ser alterada de ",["$","em",null,{"className":"italic text-gray-700","children":"rascunho"}]," depois de já ter sido alterada para ",["$","em",null,{"className":"italic text-gray-700","children":"publicada"}]," em algum momento.","\n",["$","ul",null,{"className":"list-disc pl-6 mb-6 space-y-2","children":["\n",["$","li",null,{"className":"text-gray-700","children":["Essa ",["$","em",null,{"className":"italic text-gray-700","children":"regra"}]," deve ser entendida como uma regra de transação"]}],"\n"]}],"\n"]}],"\n",["$","li",null,{"className":"text-gray-700","children":["Uma publicação não deve ser criada sem um título","\n",["$","ul",null,{"className":"list-disc pl-6 mb-6 space-y-2","children":["\n",["$","li",null,{"className":"text-gray-700","children":["Essa ",["$","em",null,{"className":"italic text-gray-700","children":"regra"}]," deve ser entendida como uma regra de consistência"]}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["O que está por trás dessa distinção é a noção ",["$","em",null,{"className":"italic text-gray-700","children":"tempo"}],". Uma regra de consistência precisa ser valida em qualquer dado momento do ciclo de vida da nossa aplicação. Por sua vez, uma validação de transação só faz sentido num fluxo dinâmico de alterações."]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["Ambas validações podem ser feitas dentro de um model Rails (ActiveModel) comum através da reserved keyword ",["$","em",null,{"className":"italic text-gray-700","children":"validate(s)"}],"."]}],"\n",["$","div",null,{"className":"relative mb-6","children":[["$","div",null,{"className":"absolute top-0 right-0 bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-bl-lg rounded-tr-lg","children":"ruby"}],["$","pre",null,{"className":"language-ruby bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto pt-8","children":["$","code",null,{"className":"language-ruby","children":"class Post < ApplicationRecord\n\t  validate :prevent_drafting_published,\n\t    if: -> { published? && will_save_change_to_draft? }\n\t    \n\t  validates :title, presence: true\n\t  \n\t  def prevent_drafting_published\n\t    errors.add(:base, \"Switching back to draft is not\n\t      allowed for published posts\")\n\t  end\nend\n"}]}]]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["Note como a validação de transação só pode existir apartir de uma ",["$","em",null,{"className":"italic text-gray-700","children":"condição"}],", o que denota sua caracterisca dinâmica. Enquanto a validação de consistência não precisa de condição nenhuma para que seja uma regra necessária."]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["Esse primeiro tipo de validação, que exige uma condição, normalmente contribui para um problema de quebra de responsabilidade. ",["$","strong",null,{"className":"font-semibold text-gray-900","children":"Um model deve declarar suas validações mas não deve implementa-las"}],". Se nos atermos a essa regra vamos perceber que o proprio rails já a segue. Quando usamos o ",["$","em",null,{"className":"italic text-gray-700","children":"validates presence: true"}],", estamos declarando a validação em nosso model e usando uma implementação externa a ele, no caso a classe ",["$","strong",null,{"className":"font-semibold text-gray-900","children":["$","a",null,{"className":"text-green-600 hover:text-green-700 hover:underline transition-colors","href":"https://www.rubydoc.info/docs/rails/ActiveModel/Validations/PresenceValidator","children":"PresenceValidator"}]}]," implementa as regras de presença de atributos."]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"Desta mesma forma, o livro nos mostra que podemos implementar nossos proprios métodos de validações, externos aos models e que extendem da mesma classe da qual extendem os metódos de validação padrão do rails."}],"\n",["$","div",null,{"className":"relative mb-6","children":[["$","div",null,{"className":"absolute top-0 right-0 bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-bl-lg rounded-tr-lg","children":"ruby"}],["$","pre",null,{"className":"language-ruby bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto pt-8","children":["$","code",null,{"className":"language-ruby","children":"class Post::DraftValidator < ActiveModel::Validator\n  def validate(post)\n\t    return unless post.published?\n\t    return unless post.will_save_change_to_draft\n\t    \n\t    post.errors.add(:base, \"Switching back to draft is not\n\t      allowed for published posts\")\n\t  end\nend\n\nclass Post < ApplicationRecord\n\t  validates_with DraftValidator\nend\n"}]}]]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"Essa refatoração nos permite extrair a implementação das regras de validação para classes separadas em seus proprios contextos enquanto nosso model ainda mantem o mesmo comportamento."}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["Além dessa refatoração, outra consideração importante apontada é a relacionada aos contextos de validações. Quando diretamente no model as validações são ",["$","em",null,{"className":"italic text-gray-700","children":"context-free"}]," ou seja, executam sempre que houve um ",["$","em",null,{"className":"italic text-gray-700","children":"commit"}]," (seja um save ou update), independente de qualquer contexto envolto na ação, o que pode tornar muitas validações redundantes. Para isso o ActiveRecord nos fornece a opção ",["$","em",null,{"className":"italic text-gray-700","children":"on"}],", que normalmente é usada para restringir callbacks e validações a criação ou atualização (on: :create ou on: :update), porém também podemos criar nossos próprios contextos em um model. Em nosso exemplo:"]}],"\n",["$","div",null,{"className":"relative mb-6","children":[["$","div",null,{"className":"absolute top-0 right-0 bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-bl-lg rounded-tr-lg","children":"ruby"}],["$","pre",null,{"className":"language-ruby bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto pt-8","children":["$","code",null,{"className":"language-ruby","children":"class Post < ApplicationRecord\n\t  validates_with DraftValidator, on: :draft\n\t  \n\t  def draft\n\t\t  self.status = :draft\n\t\t  save!(context: :draft)\n\t  end\nend\n"}]}]]}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"Esse contexto permite remover a linha \"return unless post.published?\" do validator e torna ele menos dependente do model."}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"Com essas refatorações nossas validações continuam proximas ao Rails Way e também distantes dos problemas comuns aos adicionarmos validações diretamente nos models."}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"--"}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":"A referência pra essa postagem:"}],"\n",["$","p",null,{"className":"text-gray-700 leading-relaxed mb-4","children":["$","div",null,{"className":"my-8 flex justify-center","children":["$","$Le",null,{"src":"/images/blog/layerdDesign.png","alt":"Image description","width":600,"height":300,"className":"rounded-lg shadow-lg max-w-2xl w-full h-auto"}]}]}]]}}]
b:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
9:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Melhores Validações | Blog de Vinicius Lisboa"}],["$","meta","2",{"name":"description","content":"Validando on rails"}],["$","link","3",{"rel":"manifest","href":"/manifest.webmanifest","crossOrigin":"$undefined"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"property":"og:title","content":"Melhores Validações"}],["$","meta","6",{"property":"og:description","content":"Validando on rails"}],["$","meta","7",{"property":"og:url","content":"https://viniciuslisboa07.github.io/blog/melhores-validacoes"}],["$","meta","8",{"property":"og:site_name","content":"Blog de Vinicius Lisboa"}],["$","meta","9",{"property":"og:image","content":"http://localhost:3000/images/blog/validacao.png"}],["$","meta","10",{"property":"og:image:width","content":"1200"}],["$","meta","11",{"property":"og:image:height","content":"630"}],["$","meta","12",{"property":"og:image:alt","content":"Melhores Validações"}],["$","meta","13",{"property":"og:type","content":"article"}],["$","meta","14",{"property":"article:published_time","content":"2025-12-27"}],["$","meta","15",{"property":"article:author","content":"Vinicius Lisboa"}],["$","meta","16",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","17",{"name":"twitter:title","content":"Melhores Validações"}],["$","meta","18",{"name":"twitter:description","content":"Validando on rails"}],["$","meta","19",{"name":"twitter:image","content":"http://localhost:3000/images/blog/validacao.png"}],["$","link","20",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","link","21",{"rel":"icon","href":"/icon?eacec83176f30837","alt":"$undefined","type":"image/png","sizes":"32x32"}]]
7:null
